import{r as y,a as bt,c as vt,g as yt,R as X,C as We,b as Be,L as He,P as Ge,d as qe,p as ze,e as Ke,f as Ze,h as wt}from"./vendor-tNaIbbzP.js";import{g as jt,_ as Nt,a as _t,b as St,c as kt,C as It,r as Re,d as Ct,S as Rt,F as Pt,i as Mt,e as Tt,f as $,h as ne,s as ve,p as Ye,q as Ot,o as Et,j as ge}from"./firebase-B1L06kZz.js";import{X as ae,C as ye,U as Ut,T as Dt,a as we,b as At,c as Ft,B as Pe,d as Q,e as ee,S as Me,f as xe,M as $t,V as Lt,g as Vt}from"./ui-Ba7fZm5B.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const n of d)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(d){const n={};return d.integrity&&(n.integrity=d.integrity),d.referrerPolicy&&(n.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?n.credentials="include":d.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(d){if(d.ep)return;d.ep=!0;const n=r(d);fetch(d.href,n)}})();var Je={exports:{}},le={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wt=y,Bt=Symbol.for("react.element"),Ht=Symbol.for("react.fragment"),Gt=Object.prototype.hasOwnProperty,qt=Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zt={key:!0,ref:!0,__self:!0,__source:!0};function Xe(s,t,r){var a,d={},n=null,i=null;r!==void 0&&(n=""+r),t.key!==void 0&&(n=""+t.key),t.ref!==void 0&&(i=t.ref);for(a in t)Gt.call(t,a)&&!zt.hasOwnProperty(a)&&(d[a]=t[a]);if(s&&s.defaultProps)for(a in t=s.defaultProps,t)d[a]===void 0&&(d[a]=t[a]);return{$$typeof:Bt,type:s,key:n,ref:i,props:d,_owner:qt.current}}le.Fragment=Ht;le.jsx=Xe;le.jsxs=Xe;Je.exports=le;var e=Je.exports,Qe,Te=bt;Qe=Te.createRoot,Te.hydrateRoot;const N=typeof require<"u"?function(){return require("electron")}():function(){return console.error('If you need to use "electron" in the Renderer process, make sure that "nodeIntegration" is enabled in the Main process.'),{}}();let re;if(typeof document>"u"){re={};const s=["invoke","postMessage","send","sendSync","sendTo","sendToHost","addListener","emit","eventNames","getMaxListeners","listenerCount","listeners","off","on","once","prependListener","prependOnceListener","rawListeners","removeAllListeners","removeListener","setMaxListeners"];for(const t of s)re[t]=()=>{throw new Error(`ipcRenderer doesn't work in a Web Worker.
You can see https://github.com/electron-vite/vite-plugin-electron/issues/69`)}}else re=N.ipcRenderer;N.clipboard;N.contextBridge;N.crashReporter;const et=re;N.nativeImage;N.shell;N.webFrame;N.deprecate;N.app;N.autoUpdater;N.BaseWindow;N.BrowserView;N.BrowserWindow;N.contentTracing;N.desktopCapturer;N.dialog;N.globalShortcut;N.inAppPurchase;N.ipcMain;N.Menu;N.MessageChannelMain;N.MessagePortMain;N.nativeTheme;N.netLog;N.Notification;N.powerMonitor;N.powerSaveBlocker;N.protocol;N.pushNotifications;N.safeStorage;N.screen;N.session;N.ShareMenu;N.TouchBar;N.Tray;N.utilityProcess;N.webContents;N.WebContentsView;N.webFrameMain;N.View;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tt="firebasestorage.googleapis.com",Kt="storageBucket",Zt=2*60*1e3,Yt=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G extends Pt{constructor(t,r,a=0){super(be(t),`Firebase Storage: ${r} (${be(t)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,G.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return be(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var H;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(H||(H={}));function be(s){return"storage/"+s}function Jt(){const s="An unknown error occurred, please check the error payload for server response.";return new G(H.UNKNOWN,s)}function Xt(){return new G(H.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Qt(){return new G(H.CANCELED,"User canceled the upload/download.")}function es(s){return new G(H.INVALID_URL,"Invalid URL '"+s+"'.")}function ts(s){return new G(H.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function Oe(s){return new G(H.INVALID_ARGUMENT,s)}function st(){return new G(H.APP_DELETED,"The Firebase app was deleted.")}function ss(s){return new G(H.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let a;try{a=L.makeFromUrl(t,r)}catch{return new L(t,"")}if(a.path==="")return a;throw ts(t)}static makeFromUrl(t,r){let a=null;const d="([A-Za-z0-9.\\-_]+)";function n(b){b.path.charAt(b.path.length-1)==="/"&&(b.path_=b.path_.slice(0,-1))}const i="(/(.*))?$",h=new RegExp("^gs://"+d+i,"i"),m={bucket:1,path:3};function w(b){b.path_=decodeURIComponent(b.path)}const C="v[A-Za-z0-9_]+",v=r.replace(/[.]/g,"\\."),x="(/([^?#]*).*)?$",p=new RegExp(`^https?://${v}/${C}/b/${d}/o${x}`,"i"),o={bucket:1,path:3},u=r===tt?"(?:storage.googleapis.com|storage.cloud.google.com)":r,f="([^?#]*)",g=new RegExp(`^https?://${u}/${d}/${f}`,"i"),_=[{regex:h,indices:m,postModify:n},{regex:p,indices:o,postModify:w},{regex:g,indices:{bucket:1,path:2},postModify:w}];for(let b=0;b<_.length;b++){const M=_[b],S=M.regex.exec(t);if(S){const I=S[M.indices.bucket];let O=S[M.indices.path];O||(O=""),a=new L(I,O),M.postModify(a);break}}if(a==null)throw es(t);return a}}class rs{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(s,t,r){let a=1,d=null,n=null,i=!1,h=0;function m(){return h===2}let w=!1;function C(...f){w||(w=!0,t.apply(null,f))}function v(f){d=setTimeout(()=>{d=null,s(p,m())},f)}function x(){n&&clearTimeout(n)}function p(f,...g){if(w){x();return}if(f){x(),C.call(null,f,...g);return}if(m()||i){x(),C.call(null,f,...g);return}a<64&&(a*=2);let _;h===1?(h=2,_=0):_=(a+Math.random())*1e3,v(_)}let o=!1;function u(f){o||(o=!0,x(),!w&&(d!==null?(f||(h=2),clearTimeout(d),v(0)):f||(h=1)))}return v(0),n=setTimeout(()=>{i=!0,u(!0)},r),u}function as(s){s(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function is(s){return s!==void 0}function Ee(s,t,r,a){if(a<t)throw Oe(`Invalid value for '${s}'. Expected ${t} or greater.`);if(a>r)throw Oe(`Invalid value for '${s}'. Expected ${r} or less.`)}function os(s){const t=encodeURIComponent;let r="?";for(const a in s)if(s.hasOwnProperty(a)){const d=t(a)+"="+t(s[a]);r=r+d+"&"}return r=r.slice(0,-1),r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ie;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(ie||(ie={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(s,t){const r=s>=500&&s<600,d=[408,429].indexOf(s)!==-1,n=t.indexOf(s)!==-1;return r||d||n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(t,r,a,d,n,i,h,m,w,C,v,x=!0){this.url_=t,this.method_=r,this.headers_=a,this.body_=d,this.successCodes_=n,this.additionalRetryCodes_=i,this.callback_=h,this.errorCallback_=m,this.timeout_=w,this.progressCallback_=C,this.connectionFactory_=v,this.retry=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,o)=>{this.resolve_=p,this.reject_=o,this.start_()})}start_(){const t=(a,d)=>{if(d){a(!1,new te(!1,null,!0));return}const n=this.connectionFactory_();this.pendingConnection_=n;const i=h=>{const m=h.loaded,w=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(m,w)};this.progressCallback_!==null&&n.addUploadProgressListener(i),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&n.removeUploadProgressListener(i),this.pendingConnection_=null;const h=n.getErrorCode()===ie.NO_ERROR,m=n.getStatus();if(!h||cs(m,this.additionalRetryCodes_)&&this.retry){const C=n.getErrorCode()===ie.ABORT;a(!1,new te(!1,null,C));return}const w=this.successCodes_.indexOf(m)!==-1;a(!0,new te(w,n))})},r=(a,d)=>{const n=this.resolve_,i=this.reject_,h=d.connection;if(d.wasSuccessCode)try{const m=this.callback_(h,h.getResponse());is(m)?n(m):n()}catch(m){i(m)}else if(h!==null){const m=Jt();m.serverResponse=h.getErrorText(),this.errorCallback_?i(this.errorCallback_(h,m)):i(m)}else if(d.canceled){const m=this.appDelete_?st():Qt();i(m)}else{const m=Xt();i(m)}};this.canceled_?r(!1,new te(!1,null,!0)):this.backoffId_=ns(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&as(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class te{constructor(t,r,a){this.wasSuccessCode=t,this.connection=r,this.canceled=!!a}}function ds(s,t){t!==null&&t.length>0&&(s.Authorization="Firebase "+t)}function us(s,t){s["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function ms(s,t){t&&(s["X-Firebase-GMPID"]=t)}function hs(s,t){t!==null&&(s["X-Firebase-AppCheck"]=t)}function fs(s,t,r,a,d,n,i=!0){const h=os(s.urlParams),m=s.url+h,w=Object.assign({},s.headers);return ms(w,t),ds(w,r),us(w,n),hs(w,a),new ls(m,s.method,w,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,d,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ps(s){if(s.length===0)return null;const t=s.lastIndexOf("/");return t===-1?"":s.slice(0,t)}function gs(s){const t=s.lastIndexOf("/",s.length-2);return t===-1?s:s.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(t,r){this._service=t,r instanceof L?this._location=r:this._location=L.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new oe(t,r)}get root(){const t=new L(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return gs(this._location.path)}get storage(){return this._service}get parent(){const t=ps(this._location.path);if(t===null)return null;const r=new L(this._location.bucket,t);return new oe(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw ss(t)}}function Ue(s,t){const r=t?.[Kt];return r==null?null:L.makeFromBucketSpec(r,s)}function xs(s,t,r,a={}){s.host=`${t}:${r}`,s._protocol="http";const{mockUserToken:d}=a;d&&(s._overrideAuthToken=typeof d=="string"?d:Ct(d,s.app.options.projectId))}class bs{constructor(t,r,a,d,n){this.app=t,this._authProvider=r,this._appCheckProvider=a,this._url=d,this._firebaseVersion=n,this._bucket=null,this._host=tt,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Zt,this._maxUploadRetryTime=Yt,this._requests=new Set,d!=null?this._bucket=L.makeFromBucketSpec(d,this._host):this._bucket=Ue(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=L.makeFromBucketSpec(this._url,t):this._bucket=Ue(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Ee("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Ee("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new oe(this,t)}_makeRequest(t,r,a,d,n=!0){if(this._deleted)return new rs(st());{const i=fs(t,this._appId,a,d,r,this._firebaseVersion,n);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(t,r){const[a,d]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,a,d).getPromise()}}const De="@firebase/storage",Ae="0.12.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rt="storage";function vs(s=St(),t){s=jt(s);const a=Nt(s,rt).getImmediate({identifier:t}),d=_t("storage");return d&&ys(a,...d),a}function ys(s,t,r,a={}){xs(s,t,r,a)}function ws(s,{instanceIdentifier:t}){const r=s.getProvider("app").getImmediate(),a=s.getProvider("auth-internal"),d=s.getProvider("app-check-internal");return new bs(r,a,d,t,Rt)}function js(){kt(new It(rt,ws,"PUBLIC").setMultipleInstances(!0)),Re(De,Ae,""),Re(De,Ae,"esm2017")}js();const Ns=require,c=Ns("fs");c.appendFile;c.appendFileSync;c.access;c.accessSync;c.chown;c.chownSync;c.chmod;c.chmodSync;c.close;c.closeSync;c.copyFile;c.copyFileSync;c.cp;c.cpSync;c.createReadStream;c.createWriteStream;c.exists;c.existsSync;c.fchown;c.fchownSync;c.fchmod;c.fchmodSync;c.fdatasync;c.fdatasyncSync;c.fstat;c.fstatSync;c.fsync;c.fsyncSync;c.ftruncate;c.ftruncateSync;c.futimes;c.futimesSync;c.glob;c.globSync;c.lchown;c.lchownSync;c.lchmod;c.lchmodSync;c.link;c.linkSync;c.lstat;c.lstatSync;c.lutimes;c.lutimesSync;c.mkdir;c.mkdirSync;c.mkdtemp;c.mkdtempSync;c.open;c.openSync;c.openAsBlob;c.readdir;c.readdirSync;c.read;c.readSync;c.readv;c.readvSync;c.readFile;c.readFileSync;c.readlink;c.readlinkSync;c.realpath;c.realpathSync;c.rename;c.renameSync;c.rm;c.rmSync;c.rmdir;c.rmdirSync;c.stat;c.statfs;c.statSync;c.statfsSync;c.symlink;c.symlinkSync;c.truncate;c.truncateSync;c.unwatchFile;c.unlink;c.unlinkSync;c.utimes;c.utimesSync;c.watch;c.watchFile;c.writeFile;c.writeFileSync;c.write;c.writeSync;c.writev;c.writevSync;c.Dirent;c.Stats;c.ReadStream;c.WriteStream;c.FileReadStream;c.FileWriteStream;c._toUnixTimestamp;c.Dir;c.opendir;c.opendirSync;c.F_OK;c.R_OK;c.W_OK;c.X_OK;c.constants;const Fe=c.promises;c.default;const _s=require,T=_s("path");T.resolve;T.normalize;T.isAbsolute;T.join;T.relative;T.toNamespacedPath;T.dirname;T.basename;T.extname;T.format;T.parse;T.matchesGlob;T.sep;T.delimiter;T.win32;T.posix;T._makeLong;const ce=T.default||T,Ss={apiKey:"AIzaSyDNmM3wDlFN_-7MAjOZQc9YxDYy9-EyDvI",authDomain:"nova-dristi.firebaseapp.com",databaseURL:"https://nova-dristi-default-rtdb.firebaseio.com",projectId:"nova-dristi",storageBucket:"nova-dristi.appspot.com",messagingSenderId:"655884715976",appId:"1:655884715976:web:e7c7c8c8e8c8c8c8e8c8c8"},nt=Mt(Ss),V=Tt(nt);vs(nt);async function ks(s,t){try{const r=t.get("name"),a=t.get("address"),d=t.get("phone"),n=t.get("image");if(!r)throw new Error("Name is required");const i=new Date().toISOString(),h=r.toLowerCase().replace(/\s+/g,"_"),m=$(V,s),C=(await ne(m)).val()||{};let v=0,x=h;const p=r;for(;C[x];)v++,x=`${h}_${v}`;const o={name:p,systemName:v>0?`${r} ${v}`:r,address:a||null,phone:d||null,createdAt:i,updatedAt:i};let u;if(s==="customers"?u={...o,visitCount:0,lastVisit:0,favoriteItems:[],totalSpent:0}:u={...o,lastVisit:0},n&&n.size>0)try{const R=`${x}.jpg`,_=ce.join(process.resourcesPath,"backend","faces",s,R),b=ce.dirname(_);await Fe.mkdir(b,{recursive:!0});const M=await n.arrayBuffer();await Fe.writeFile(_,Buffer.from(M)),u.imagePath=`/faces/${s}/${R}`}catch(R){return console.error("Failed to save image:",R),{success:!1,error:R}}const f=$(V,`${s}/${x}`);await ve(f,u);const g=$(V,"activity");return await Ye(g,{type:"profile_created",profileType:s,profileId:x,name:p,timestamp:i}),{success:!0,data:u}}catch(r){return console.error("Error adding profile:",r),{success:!1,error:r}}}async function Is(s,t){try{const r=$(V,`${s}/${t}`),d=(await ne(r)).val();if(!d)throw new Error("Profile data not found");try{et.invoke("delete-profile-image",d.imagePath)}catch(m){console.error("Error deleting image:",m)}const n=$(V,"visits"),i=await ne(n);if(i.exists()){const m=i.val();for(const[w,C]of Object.entries(m))if(C.name===d.name){const v=$(V,`visits/${w}`);await ve(v,null)}}await ve(r,null);const h=$(V,"activity");return await Ye(h,{type:"profile_deleted",profileType:s,profileId:t,name:d.name,timestamp:new Date().toISOString()}),{success:!0}}catch(r){return console.error("Error deleting profile:",r),{success:!1,error:r}}}var at={exports:{}};(function(s,t){(function(a,d){s.exports=d(y)})(vt,function(r){return function(a){var d={};function n(i){if(d[i])return d[i].exports;var h=d[i]={i,l:!1,exports:{}};return a[i].call(h.exports,h,h.exports,n),h.l=!0,h.exports}return n.m=a,n.c=d,n.d=function(i,h,m){n.o(i,h)||Object.defineProperty(i,h,{enumerable:!0,get:m})},n.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,h){if(h&1&&(i=n(i)),h&8||h&4&&typeof i=="object"&&i&&i.__esModule)return i;var m=Object.create(null);if(n.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:i}),h&2&&typeof i!="string")for(var w in i)n.d(m,w,function(C){return i[C]}.bind(null,w));return m},n.n=function(i){var h=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(h,"a",h),h},n.o=function(i,h){return Object.prototype.hasOwnProperty.call(i,h)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(a,d,n){n.r(d);var i=n("react"),h=function(){var x=function(p,o){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var g in f)f.hasOwnProperty(g)&&(u[g]=f[g])},x(p,o)};return function(p,o){x(p,o);function u(){this.constructor=p}p.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}(),m=function(){return m=Object.assign||function(x){for(var p,o=1,u=arguments.length;o<u;o++){p=arguments[o];for(var f in p)Object.prototype.hasOwnProperty.call(p,f)&&(x[f]=p[f])}return x},m.apply(this,arguments)},w=function(x,p){var o={};for(var u in x)Object.prototype.hasOwnProperty.call(x,u)&&p.indexOf(u)<0&&(o[u]=x[u]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,u=Object.getOwnPropertySymbols(x);f<u.length;f++)p.indexOf(u[f])<0&&Object.prototype.propertyIsEnumerable.call(x,u[f])&&(o[u[f]]=x[u[f]]);return o};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(p){var o=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return o?new Promise(function(u,f){o.call(navigator,p,u,f)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function C(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var v=function(x){h(p,x);function p(o){var u=x.call(this,o)||this;return u.canvas=null,u.ctx=null,u.requestUserMediaId=0,u.unmounted=!1,u.state={hasUserMedia:!1},u}return p.prototype.componentDidMount=function(){var o=this,u=o.state,f=o.props;if(this.unmounted=!1,!C()){f.onUserMediaError("getUserMedia not supported");return}u.hasUserMedia||this.requestUserMedia(),f.children&&typeof f.children!="function"&&console.warn("children must be a function")},p.prototype.componentDidUpdate=function(o){var u=this.props;if(!C()){u.onUserMediaError("getUserMedia not supported");return}var f=JSON.stringify(o.audioConstraints)!==JSON.stringify(u.audioConstraints),g=JSON.stringify(o.videoConstraints)!==JSON.stringify(u.videoConstraints),R=o.minScreenshotWidth!==u.minScreenshotWidth,_=o.minScreenshotHeight!==u.minScreenshotHeight;(g||R||_)&&(this.canvas=null,this.ctx=null),(f||g)&&(this.stopAndCleanup(),this.requestUserMedia())},p.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},p.stopMediaStream=function(o){o&&(o.getVideoTracks&&o.getAudioTracks?(o.getVideoTracks().map(function(u){o.removeTrack(u),u.stop()}),o.getAudioTracks().map(function(u){o.removeTrack(u),u.stop()})):o.stop())},p.prototype.stopAndCleanup=function(){var o=this.state;o.hasUserMedia&&(p.stopMediaStream(this.stream),o.src&&window.URL.revokeObjectURL(o.src))},p.prototype.getScreenshot=function(o){var u=this,f=u.state,g=u.props;if(!f.hasUserMedia)return null;var R=this.getCanvas(o);return R&&R.toDataURL(g.screenshotFormat,g.screenshotQuality)},p.prototype.getCanvas=function(o){var u=this,f=u.state,g=u.props;if(!this.video||!f.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var R=this.video.videoWidth,_=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var b=R/_;R=g.minScreenshotWidth||this.video.clientWidth,_=R/b,g.minScreenshotHeight&&_<g.minScreenshotHeight&&(_=g.minScreenshotHeight,R=_*b)}this.canvas=document.createElement("canvas"),this.canvas.width=o?.width||R,this.canvas.height=o?.height||_,this.ctx=this.canvas.getContext("2d")}var M=this,S=M.ctx,I=M.canvas;return S&&I&&(I.width=o?.width||I.width,I.height=o?.height||I.height,g.mirrored&&(S.translate(I.width,0),S.scale(-1,1)),S.imageSmoothingEnabled=g.imageSmoothing,S.drawImage(this.video,0,0,o?.width||I.width,o?.height||I.height),g.mirrored&&(S.scale(-1,1),S.translate(-I.width,0))),I},p.prototype.requestUserMedia=function(){var o=this,u=this.props,f=function(_,b){var M={video:typeof b<"u"?b:!0};u.audio&&(M.audio=typeof _<"u"?_:!0),o.requestUserMediaId++;var S=o.requestUserMediaId;navigator.mediaDevices.getUserMedia(M).then(function(I){o.unmounted||S!==o.requestUserMediaId?p.stopMediaStream(I):o.handleUserMedia(null,I)}).catch(function(I){o.handleUserMedia(I)})};if("mediaDevices"in navigator)f(u.audioConstraints,u.videoConstraints);else{var g=function(_){return{optional:[{sourceId:_}]}},R=function(_){var b=_.deviceId;return typeof b=="string"?b:Array.isArray(b)&&b.length>0?b[0]:typeof b=="object"&&b.ideal?b.ideal:null};MediaStreamTrack.getSources(function(_){var b=null,M=null;_.forEach(function(O){O.kind==="audio"?b=O.id:O.kind==="video"&&(M=O.id)});var S=R(u.audioConstraints);S&&(b=S);var I=R(u.videoConstraints);I&&(M=I),f(g(b),g(M))})}},p.prototype.handleUserMedia=function(o,u){var f=this.props;if(o||!u){this.setState({hasUserMedia:!1}),f.onUserMediaError(o);return}this.stream=u;try{this.video&&(this.video.srcObject=u),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(u)})}f.onUserMedia(u)},p.prototype.render=function(){var o=this,u=this,f=u.state,g=u.props,R=g.audio;g.forceScreenshotSourceSize;var _=g.disablePictureInPicture;g.onUserMedia,g.onUserMediaError,g.screenshotFormat,g.screenshotQuality,g.minScreenshotWidth,g.minScreenshotHeight,g.audioConstraints,g.videoConstraints,g.imageSmoothing;var b=g.mirrored,M=g.style,S=M===void 0?{}:M,I=g.children,O=w(g,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),J=b?m(m({},S),{transform:(S.transform||"")+" scaleX(-1)"}):S,de={getScreenshot:this.getScreenshot.bind(this)};return i.createElement(i.Fragment,null,i.createElement("video",m({autoPlay:!0,disablePictureInPicture:_,src:f.src,muted:!R,playsInline:!0,ref:function(ue){o.video=ue},style:J},O)),I&&I(de))},p.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},p}(i.Component);d.default=v},react:function(a,d){a.exports=r}}).default})})(at);var Cs=at.exports;const Rs=yt(Cs);class Ps{constructor(){this.isPlaying=!1,this.voices=[],this.preferredVoices=new Map,this.lastUnknownGreeting=new Map,this.loadVoices(),window.speechSynthesis.onvoiceschanged=()=>{this.loadVoices()}}loadVoices(){this.voices=window.speechSynthesis.getVoices();for(const t of this.voices){const r=t.name.toLowerCase();(r.includes("google")||r.includes("microsoft")||r.includes("samantha"))&&(r.includes("female")&&!this.preferredVoices.has("female")?this.preferredVoices.set("female",t):(r.includes("male")||r.includes("david"))&&!this.preferredVoices.has("male")&&this.preferredVoices.set("male",t))}}getPreferredVoice(t){if(t){const r=t.toLowerCase();if(this.preferredVoices.has(r))return this.preferredVoices.get(r)}return this.voices.find(r=>r.lang==="en-US")||this.voices[0]}async speakWithPause(t,r){return new Promise((a,d)=>{try{window.speechSynthesis.cancel();const n=new SpeechSynthesisUtterance(t),i=this.getPreferredVoice(r);i&&(n.voice=i),n.rate=.9,n.pitch=r?.toLowerCase()==="female"?1.1:.9,n.volume=1,n.onend=()=>{setTimeout(a,300)},n.onerror=d,window.speechSynthesis.speak(n)}catch(n){d(n)}})}async speak(t,r,a){if(!this.isPlaying)try{if(r==="unknown"&&t){const d=Date.now(),n=`${a||"unknown"}-${t}`,i=this.lastUnknownGreeting.get(n)||0;if(d-i<2e3)return;this.lastUnknownGreeting.set(n,d);for(const[h,m]of this.lastUnknownGreeting)d-m>1e4&&this.lastUnknownGreeting.delete(h)}this.isPlaying=!0,await this.speakWithPause(t,a)}catch(d){console.error("Speech synthesis failed:",d)}finally{this.isPlaying=!1}}close(){window.speechSynthesis.cancel(),this.isPlaying=!1}}function Ms({isOpen:s,onClose:t,onSave:r,type:a}){const[d,n]=X.useState(null),[i,h]=X.useState(""),m=X.useRef(null);X.useEffect(()=>{s||(n(null),h(""))},[s]);const w=v=>{v.preventDefault();const x=v.target,p=new FormData(x);p.append("type",a),d&&p.append("image",d),r(p),t()},C=v=>{if(v.target.files&&v.target.files[0]){const x=v.target.files[0];n(x),h(URL.createObjectURL(x))}};return s?e.jsx("div",{onClick:v=>v.target===v.currentTarget&&t(),className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto py-4 transition-opacity duration-300",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 w-[300px] max-h-[60vh] overflow-y-auto transition-transform duration-300 transform scale-100",onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Add New ",a==="staff"?"Staff Member":"Customer"]}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsxs("div",{className:"relative",children:[i?e.jsx("img",{src:i,alt:"Preview",className:"w-32 h-32 rounded-full object-cover"}):e.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(ye,{className:"w-8 h-8 text-gray-400"})}),e.jsx("button",{type:"button",onClick:()=>m.current?.click(),className:"absolute bottom-0 right-0 bg-blue-500 rounded-full p-2 text-white hover:bg-blue-600",children:e.jsx(Ut,{className:"w-4 h-4"})})]})}),e.jsx("input",{ref:m,type:"file",accept:"image/*",onChange:C,className:"hidden"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",name:"name",required:!0,className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a==="customer"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",name:"address",className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Save"})]})]})]})}):null}We.register(Be,He,Ge,qe,ze,Ke,Ze);function Ts({isOpen:s,onClose:t,profile:r}){const[a,d]=y.useState([]),[n,i]=y.useState({labels:[],data:[]}),[h,m]=y.useState(!1),[w,C]=y.useState("");y.useEffect(()=>{s&&r&&(async()=>{if(r?.imagePath)try{if(await et.invoke("get-resource-path",r.imagePath)){const f=r.imagePath.replace("/backend","");C(ce.join(process.resourcesPath,"backend",f))}else console.error("Image path not found:",r.imagePath),C("")}catch(u){console.error("Error getting resource path:",u),C("")}else C("")})()},[s,r]),y.useEffect(()=>{s&&r&&(async()=>{if(r?.name)try{const u=$(V,"visits"),f=Ot(u,Et("name")),g=await ne(f);if(g.exists()){const _=Object.values(g.val()).filter(S=>S.name===r.name);d(_);const b={};_.forEach(S=>{const O=new Date(S.time).toLocaleString("default",{month:"short",year:"2-digit"});b[O]=(b[O]||0)+1});const M=Object.keys(b).sort((S,I)=>{const O=new Date(S),J=new Date(I);return O.getTime()-J.getTime()});i({labels:M,data:M.map(S=>b[S])})}}catch(u){console.error("Error fetching visits:",u)}})()},[s,r]);const v=async()=>{if(r&&window.confirm(`Are you sure you want to delete ${r.name}'s profile?`)){m(!0);try{(await Is(r.type,r.systemName?.toLowerCase().replace(/\s+/g,"_")||r.name.toLowerCase().replace(/\s+/g,"_"))).success?t():alert("Failed to delete profile")}catch(o){console.error("Error deleting profile:",o),alert("Failed to delete profile")}finally{m(!1)}}};if(!s||!r)return null;const x={labels:n.labels,datasets:[{label:"Visits",data:n.data,borderColor:"rgb(75, 192, 192)",tension:.1}]},p="https://images.unsplash.com/photo-1633332755192-727a05c4013d?auto=format&fit=crop&w=200&h=200";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:o=>{o.target===o.currentTarget&&(o.preventDefault(),o.stopPropagation(),t())},children:e.jsxs("div",{className:"bg-white rounded-lg p-4 w-[80%] max-w-md h-[60vh] m-4 overflow-y-auto relative",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:w||p,alt:r.name,className:"w-20 h-20 rounded-full object-cover border-2 border-gray-200",onError:o=>{const u=o.target;u.src=p}}),r.systemName&&r.systemName!==r.name&&e.jsx("div",{className:"absolute -bottom-2 -right-2 bg-blue-500 text-white text-xs px-2 py-1 rounded-full",children:r.systemName.split(" ").pop()})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:r.name}),e.jsx("p",{className:"text-gray-600 capitalize",children:r.type})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:v,disabled:h,className:"text-red-500 hover:text-red-700 p-2 rounded-full hover:bg-red-50",children:e.jsx(Dt,{className:"w-5 h-5"})}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-100",children:e.jsx(ae,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Visit Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(we,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Visits"}),e.jsx("p",{className:"text-lg font-semibold",children:a.length})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(At,{className:"w-5 h-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Last Visit"}),e.jsx("p",{className:"text-lg font-semibold",children:r.lastVisit?new Date(r.lastVisit).toLocaleDateString():"N/A"})]})]})]})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Visit Trends"}),e.jsx("div",{className:"h-64",children:e.jsx(wt,{data:x,options:{maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}})})]})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Activity"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"space-y-3",children:[a.slice(-5).reverse().map((o,u)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b last:border-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(we,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:new Date(o.time).toLocaleString()})]}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:o.type})]},u)),a.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"No recent activity"})]})})]})]})})}const Os=({faces:s,onAdd:t,onRemoveFace:r})=>{const[a,d]=y.useState(null),[n,i]=y.useState({name:"",address:"",phone:"",type:"customer"}),h=v=>{d(v),i({name:"",address:"",phone:"",type:"customer"})},m=v=>{i({...n,[v.target.name]:v.target.value})},w=v=>{i({...n,type:v.target.value})},C=async v=>{if(v.preventDefault(),a===null)return;const x=s[a],p=new FormData;if(p.append("name",n.name),p.append("address",n.address),p.append("phone",n.phone),p.append("type",n.type),x.imageSrc)try{const o=x.imageSrc.replace("http://localhost:5000",""),u=await fetch(`http://localhost:5000${o}`);if(!u.ok)throw new Error(`Failed to fetch image: ${u.statusText}`);const f=await u.blob(),g=o.split("/").pop()||"face.jpg",R=new File([f],g,{type:"image/jpeg"});p.append("image",R)}catch(o){console.error("Error fetching image:",o)}t(p),r(x),d(null),i({name:"",address:"",phone:"",type:"customer"})};return e.jsxs("div",{className:"flex flex-row gap-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Extracted Faces"}),e.jsx("div",{className:"grid grid-cols-4 gap-6",children:s.map((v,x)=>e.jsxs("div",{className:`relative w-48 h-48 rounded-lg bg-gray-200 flex items-center justify-center cursor-pointer border-2 transition-all duration-150 ${a===x?"border-black":"border-transparent"}`,onClick:()=>h(x),children:[v.imageSrc?e.jsx("img",{src:v.imageSrc,alt:"Detected face",className:"w-full h-full object-cover rounded-lg"}):e.jsx(ye,{className:"w-12 h-12 text-gray-300"}),a===x&&e.jsx("span",{className:"absolute top-2 right-2 bg-black text-white rounded-full p-1",children:e.jsx(Ft,{className:"w-6 h-6"})})]},x))})]}),e.jsxs("div",{className:"w-[400px] bg-white rounded-lg shadow p-8 flex flex-col items-center",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6",children:"Add Person"}),e.jsx("div",{className:"w-32 h-32 rounded-lg bg-gray-200 flex items-center justify-center mb-6",children:a!==null&&s[a]?.imageSrc?e.jsx("img",{src:s[a].imageSrc,alt:"Selected face",className:"w-full h-full object-cover rounded-lg"}):e.jsx(ye,{className:"w-12 h-12 text-gray-300"})}),e.jsxs("form",{className:"w-full flex flex-col gap-4",onSubmit:C,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Full Name"}),e.jsx("input",{type:"text",name:"name",value:n.name,onChange:m,required:!0,className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Address"}),e.jsx("input",{type:"text",name:"address",value:n.address,onChange:m,className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phone",value:n.phone,onChange:m,className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"type",value:"customer",checked:n.type==="customer",onChange:w,className:"mr-2"}),"Customer"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"type",value:"staff",checked:n.type==="staff",onChange:w,className:"mr-2"}),"Staff"]})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Add Person"})]})]})]})};We.register(Be,He,Ge,qe,ze,Ke,Ze);const se=new Map,$e=new Map,Le=["Please make yourself comfortable!","Feel free to relax and enjoy!","We're glad to have you here!","Make yourself at home!","Take your time and enjoy!","We're happy to see you!","Welcome to our space!","Enjoy your time with us!"],E=s=>{const t=s.split("").reduce((r,a)=>r+a.charCodeAt(0),0);return Le[t%Le.length]},Es=s=>{if(s.length===0)return"";if(s.length===1)return s[0];if(s.length===2)return s.join(" and ");const t=s.pop();return`${s.join(", ")}, and ${t}`},Us=s=>{const t=s.filter(h=>h.type!=="unknown"),r=s.filter(h=>h.type==="unknown"),a=[...new Set(t.map(h=>h.name))],d=r.filter(h=>h.gender==="Male").length,n=r.filter(h=>h.gender==="Female").length;if(a.length===0){if(r.length===1){const h=r[0].gender==="Female"?"ma'am":"sir";return`Welcome to AstroNova, ${h}! ${E(h)}`}return r.length===2?d===2?`Welcome to AstroNova, gentlemen! ${E("gentlemen")}`:n===2?`Welcome to AstroNova, ladies! ${E("ladies")}`:`Welcome to AstroNova! ${E("everyone")}`:`Welcome to AstroNova, everyone! ${E("everyone")}`}const i=Es(a);if(a.length===1){if(r.length===0)return`Hello ${i}! ${E(i)}`;if(r.length===1){const h=r[0].gender==="Female"?"ma'am":"sir";return`Hello ${i} and ${h}! ${E(i+h)}`}return`Hello ${i} and everyone! ${E(i+"everyone")}`}return a.length===2?r.length===0?`Hello ${i}! ${E(i)}`:`Hello ${i} and everyone! ${E(i+"everyone")}`:a.length===3?r.length===0?`Hello ${i}! ${E(i)}`:`Hello ${i} and everyone! ${E(i+"everyone")}`:r.length===0?`Hello everyone! ${E("everyone")}`:`Hello everyone! ${E("everyone")}`},Ve=(s,t,r)=>{const a=Date.now();if(t==="group"){const n=se.get(s);return!n||a-n>2*60*60*1e3?(se.set(s,a),!0):!1}if(t==="unknown"&&r){const n=`${Math.round(r.top)}-${Math.round(r.left)}`,i=$e.get(n);return!i||a-i>2e3?($e.set(n,a),!0):!1}const d=se.get(s);return!d||a-d>24*60*60*1e3?(se.set(s,a),!0):!1},Ds=(s,t,r)=>t==="unknown"?`Hello ${r==="Female"?"ma'am":"sir"}, welcome to AstroNova!`:`Hello ${s}, welcome back to AstroNova!`;function As(){const[s,t]=y.useState([]),[r,a]=y.useState([]),[d,n]=y.useState(new Map),[i,h]=y.useState({total:0,returning:0,unknown:0}),[m,w]=y.useState("dashboard"),[C,v]=y.useState([]),[x,p]=y.useState([]),[o,u]=y.useState(""),[f,g]=y.useState(""),[R,_]=y.useState(""),[b,M]=y.useState({videoDevices:[],audioDevices:[],audioOutputs:[]}),[S,I]=y.useState(!1),[O,J]=y.useState(!1),[de,ue]=y.useState("customer"),[it,ot]=y.useState(null),[ct,je]=y.useState(!1),[lt,me]=y.useState([]),he=y.useRef(null),fe=y.useRef(!1),K=y.useRef(null),[dt,Ne]=y.useState(!1),[_e,ut]=y.useState(1e3),[q,Se]=y.useState("webcam"),[z,mt]=y.useState(""),[ht,pe]=y.useState(!1),ke=y.useRef(null);y.useEffect(()=>{if(q==="ip"&&z&&ke.current){const l=ke.current,j=k=>{console.error("Video error:",k)};return l.src=z,l.play().catch(k=>{console.error("Error playing video:",k)}),l.addEventListener("error",j),()=>{l.removeEventListener("error",j),l.src=""}}},[q,z]),y.useEffect(()=>{K.current=new Ps,navigator.mediaDevices.enumerateDevices().then(D=>{const A=D.filter(B=>B.kind==="videoinput"),Z=D.filter(B=>B.kind==="audioinput"),Y=D.filter(B=>B.kind==="audiooutput");M({videoDevices:A,audioDevices:Z,audioOutputs:Y}),A.length>0&&u(A[0].deviceId),Z.length>0&&g(Z[0].deviceId),Y.length>0&&_(Y[0].deviceId)}).catch(console.error);const l=$(V,"visits"),j=$(V,"staff"),k=$(V,"customers"),P=ge(l,D=>{const A=D.val();if(A){const Z=Object.values(A);t(Z);const Y=new Date;Y.setHours(Y.getHours()-24);const B=Z.filter(F=>new Date(F.time)>Y&&F.name!=="System"&&F.name!=="Initialization"),gt=B.filter(F=>F.type==="Unknown");new Set(B.map(F=>F.name));const xt=new Set(B.filter(F=>Z.some(Ce=>Ce.name===F.name&&new Date(Ce.time)<new Date(F.time))).map(F=>F.name));h({total:B.length,returning:xt.size,unknown:gt.length})}}),W=ge(j,D=>{const A=D.val();A&&v(Object.values(A))}),U=ge(k,D=>{const A=D.val();A&&p(Object.values(A))});return()=>{P(),W(),U(),K.current&&K.current.close()}},[]);const ft=async()=>{if(!fe.current)try{fe.current=!0;let l;if(q==="webcam"&&he.current){const k=he.current.getScreenshot();if(!k)return;l=await fetch("http://localhost:5000/process-frame",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:k})})}else if(q==="ip"&&z)l=await fetch("http://localhost:5000/process-ip-camera",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({camera_url:z})});else return;const j=await l.json();if(j.status==="success"&&j.detections){a(j.detections);const k=j.detections.length>0?500:1e3;if(ut(k),j.detections.length>1){const P=Us(j.detections),W=j.detections.map(U=>U.name).sort().join("-");Ve(W,"customer",void 0)&&(K.current&&K.current.speak(P,"customer"),n(U=>new Map(U).set(W,{text:P,timestamp:Date.now()})))}else j.detections.forEach(P=>{const W=P.type==="unknown"?`unknown-${P.location.top}-${P.location.left}`:P.name;if(Ve(W,P.type,P.location)){const U=Ds(P.name,P.type,P.gender);K.current&&K.current.speak(U,P.type,P.gender),n(D=>new Map(D).set(W,{text:U,timestamp:Date.now()}))}})}}catch(l){console.error("Error processing frame:",l)}finally{fe.current=!1}};y.useEffect(()=>{const j=setInterval(async()=>{if(!dt)try{Ne(!0),await ft()}finally{Ne(!1)}},_e);return()=>clearInterval(j)},[_e]),y.useEffect(()=>{r.length!==0&&me(l=>{const j=Date.now(),k=[...l];return r.forEach(P=>{P.type==="unknown"&&(k.find(U=>Math.abs(U.location.top-P.location.top)<2&&Math.abs(U.location.left-P.location.left)<2)||k.push({...P,shownAt:j}))}),k.filter(P=>j-P.shownAt<10*60*1e3)})},[r]);const Ie=async l=>{try{const j=l.get("type"),k=await ks(j==="customer"?"customers":"staff",l);k.success?console.log("Profile added successfully"):console.error("Failed to add profile:",k.error)}catch(j){console.error("Error adding profile:",j)}},pt=l=>{me(j=>j.filter(k=>!(Math.abs(k.location.top-l.location.top)<2&&Math.abs(k.location.left-l.location.left)<2)))};return y.useEffect(()=>{m==="aiadd"&&fetch("http://localhost:5000/faces/extracted/list").then(l=>l.json()).then(l=>{if(l.status==="success"){const j=l.faces.map(k=>({name:"Unknown",type:"unknown",location:{top:0,right:0,bottom:0,left:0},shownAt:k.timestamp*1e3,imageSrc:`http://localhost:5000${k.url}`}));me(k=>{const P=j.filter(W=>{const U=W.imageSrc.replace("http://localhost:5000","");return!k.some(D=>D.imageSrc?.replace("http://localhost:5000","")===U)});return[...k,...P]})}}).catch(l=>{console.error("Error loading existing faces:",l)})},[m]),e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsxs("nav",{className:"bg-white shadow-lg",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[e.jsx("img",{src:"icon.png",alt:"Nova Dristi Logo",className:"h-8 w-8",onError:l=>{const j=l.target;j.src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTEyIDJMMiA3bDEwIDUgMTAtNS0xMC01WiIvPjxwYXRoIGQ9Ik0yIDE3bDEwIDUgMTAtNSIvPjxwYXRoIGQ9Ik0yIDEybDEwIDUgMTAtNSIvPjwvc3ZnPg=="}}),e.jsx("span",{className:"ml-2 text-xl font-bold",children:"Nova Dristi"})]}),e.jsxs("div",{className:"hidden sm:ml-6 sm:flex sm:space-x-8",children:[e.jsxs("button",{onClick:()=>w("dashboard"),className:`${m==="dashboard"?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700"} inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium`,children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Dashboard"]}),e.jsxs("button",{onClick:()=>w("staff"),className:`${m==="staff"?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700"} inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium`,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Staff"]}),e.jsxs("button",{onClick:()=>w("customers"),className:`${m==="customers"?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700"} inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium`,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Customers"]}),e.jsxs("button",{onClick:()=>w("settings"),className:`${m==="settings"?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700"} inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium`,children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Settings"]}),e.jsxs("button",{onClick:()=>w("aiadd"),className:`${m==="aiadd"?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700"} inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium`,children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"AI add"]})]})]}),e.jsx("div",{className:"flex items-center sm:hidden",children:e.jsx("button",{onClick:()=>I(!S),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",children:S?e.jsx(ae,{className:"block h-6 w-6"}):e.jsx($t,{className:"block h-6 w-6"})})})]})}),S&&e.jsx("div",{className:"sm:hidden",children:e.jsx("div",{className:"pt-2 pb-3 space-y-1",children:[{id:"dashboard",icon:Pe,label:"Dashboard"},{id:"staff",icon:Q,label:"Staff"},{id:"customers",icon:ee,label:"Customers"},{id:"settings",icon:Me,label:"Settings"}].map(({id:l,icon:j,label:k})=>e.jsx("button",{onClick:()=>{w(l),I(!1)},className:`${m===l?"bg-blue-50 border-blue-500 text-blue-700":"border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700"} block pl-3 pr-4 py-2 border-l-4 text-base font-medium w-full text-left`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),k]})},l))})})]}),e.jsxs("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[m==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"px-4 py-5 sm:p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-blue-500 rounded-md p-3",children:e.jsx(ee,{className:"h-6 w-6 text-white"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Visitors"}),e.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:i.total})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"px-4 py-5 sm:p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-green-500 rounded-md p-3",children:e.jsx(Q,{className:"h-6 w-6 text-white"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Returning Visitors"}),e.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:i.returning})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"px-4 py-5 sm:p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-purple-500 rounded-md p-3",children:e.jsx(xe,{className:"h-6 w-6 text-white"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Unknown Visitors"}),e.jsx("dd",{className:"text-lg font-semibold text-gray-900",children:i.unknown})]})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Live Feed"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("select",{value:o,onChange:l=>u(l.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:b.videoDevices.map(l=>e.jsx("option",{value:l.deviceId,children:l.label||`Camera ${l.deviceId.slice(0,5)}`},l.deviceId))})})]}),e.jsxs("div",{className:"relative",children:[q==="webcam"?e.jsx(Rs,{ref:he,audio:!1,videoConstraints:{deviceId:o,width:1280,height:720},className:"w-full rounded-lg"}):e.jsx("div",{className:"w-full h-[480px] bg-gray-200 rounded-lg overflow-hidden",children:e.jsx("img",{src:"http://localhost:5000/video_feed",className:"w-full h-full object-cover",alt:"IP Camera Stream"})}),r.map((l,j)=>e.jsx("div",{style:{position:"absolute",top:`${l.location.top}%`,left:`${l.location.left}%`,width:`${l.location.right-l.location.left}%`,height:`${l.location.bottom-l.location.top}%`,border:"2px solid",borderColor:l.type==="staff"?"#10B981":l.type==="customer"?"#3B82F6":"#F59E0B"},children:e.jsx("div",{className:`absolute -top-6 left-0 px-2 py-1 text-xs font-semibold text-white rounded-t-md ${l.type==="staff"?"bg-green-500":l.type==="customer"?"bg-blue-500":"bg-yellow-500"}`,children:l.name})},j))]})]})}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),e.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-800",children:"View all"})]}),e.jsx("div",{className:"flow-root",children:e.jsx("ul",{className:"-my-5 divide-y divide-gray-200",children:s.slice(-5).reverse().map((l,j)=>e.jsx("li",{className:"py-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`h-8 w-8 rounded-full flex items-center justify-center ${l.category==="staff"?"bg-green-100 text-green-600":l.category==="customer"?"bg-blue-100 text-blue-600":"bg-yellow-100 text-yellow-600"}`,children:l.category==="staff"?e.jsx(Q,{className:"h-5 w-5"}):e.jsx(ee,{className:"h-5 w-5"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:l.name}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(l.time).toLocaleString()})]}),e.jsx("div",{children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${l.category==="staff"?"bg-green-100 text-green-800":l.category==="customer"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:l.category})})]})},j))})})]})]})]}),(m==="staff"||m==="customers")&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:m==="staff"?"Staff Members":"Customers"}),e.jsxs("button",{onClick:()=>{ue(m==="staff"?"staff":"customer"),J(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add ",m==="staff"?"Staff":"Customer"]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:(m==="staff"?C:x).map((l,j)=>e.jsx("div",{className:"bg-white shadow rounded-lg overflow-hidden hover:shadow-lg transition-shadow duration-200 cursor-pointer",onClick:()=>{ot({...l,type:m}),je(!0)},children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:l.imagePath?ce.join(process.resourcesPath,"backend",l.imagePath.replace("/backend","")):"https://images.unsplash.com/photo-1633332755192-727a05c4013d?auto=format&fit=crop&w=200&h=200",alt:l.name,className:"h-12 w-12 rounded-full object-cover",onError:k=>{const P=k.target;P.src="https://images.unsplash.com/photo-1633332755192-727a05c4013d?auto=format&fit=crop&w=200&h=200"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:l.name}),e.jsx("p",{className:"text-sm text-gray-500",children:m==="customers"?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium",children:l.visitCount})," ","visits"]}):"Staff Member"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center text-sm text-gray-500",children:[e.jsx(we,{className:"flex-shrink-0 mr-1.5 h-4 w-4"}),e.jsxs("span",{children:["Last visit:"," ",l.lastVisit?new Date(l.lastVisit).toLocaleDateString():"Never"]})]})]})},j))})]}),m==="settings"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Device Settings"}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"camera",className:"block text-sm font-medium text-gray-700",children:"Camera"}),e.jsx("select",{id:"camera",value:o,onChange:l=>u(l.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:b.videoDevices.map(l=>e.jsx("option",{value:l.deviceId,children:l.label||`Camera ${l.deviceId.slice(0,5)}`},l.deviceId))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"audio",className:"block text-sm font-medium text-gray-700",children:"Microphone"}),e.jsx("select",{id:"audio",value:f,onChange:l=>g(l.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:b.audioDevices.map(l=>e.jsx("option",{value:l.deviceId,children:l.label||`Microphone ${l.deviceId.slice(0,5)}`},l.deviceId))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"audio",className:"block text-sm font-medium text-gray-700",children:"Speaker"}),e.jsx("select",{id:"audio",value:R,onChange:l=>_(l.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:b.audioOutputs.map(l=>e.jsx("option",{value:l.deviceId,children:l.label||`Speaker ${l.deviceId.slice(0,5)}`},l.deviceId))})]})]})]})}),e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Voice Settings"}),e.jsx("div",{className:"mt-2 max-w-xl text-sm text-gray-500",children:e.jsx("p",{children:"Configure text-to-speech settings for greetings."})}),e.jsx("div",{className:"mt-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Lt,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Voice synthesis is enabled"})]})})]})})]}),m==="aiadd"&&e.jsx(Os,{faces:lt,onAdd:Ie,onRemoveFace:pt})]}),e.jsx(Ms,{isOpen:O,onClose:()=>J(!1),onSave:Ie,type:de}),e.jsx(Ts,{isOpen:ct,onClose:()=>je(!1),profile:it}),ht&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Camera Settings"}),e.jsx("button",{onClick:()=>pe(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(ae,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Camera Type"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>Se("webcam"),className:`flex-1 p-2 rounded ${q==="webcam"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"}`,children:"Webcam"}),e.jsx("button",{onClick:()=>Se("ip"),className:`flex-1 p-2 rounded ${q==="ip"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700"}`,children:"IP Camera"})]})]}),q==="webcam"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Webcam"}),e.jsx("select",{value:o,onChange:l=>u(l.target.value),className:"w-full p-2 border rounded",children:b.videoDevices.map(l=>e.jsx("option",{value:l.deviceId,children:l.label||`Camera ${l.deviceId}`},l.deviceId))})]}),q==="ip"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"IP Camera URL"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:z,onChange:l=>mt(l.target.value),placeholder:"e.g., rtsp://username:password@192.168.1.100:554/stream",className:"flex-1 p-2 border rounded"}),e.jsx("button",{onClick:async()=>{if(z)try{const j=await(await fetch("http://localhost:5000/start_stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({camera_url:z})})).json();j.status==="success"?(u("ip-camera"),pe(!1)):(console.error("Failed to start stream:",j.message),alert("Failed to start stream: "+j.message))}catch(l){console.error("Error starting stream:",l),alert("Error starting stream. Please check the console for details.")}},className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Submit"})]})]})]})]})}),e.jsx("button",{onClick:()=>pe(!0),className:"fixed bottom-4 right-4 bg-blue-500 text-white p-3 rounded-full shadow-lg hover:bg-blue-600",children:e.jsx(Vt,{size:24})})]})}Qe(document.getElementById("root")).render(e.jsx(y.StrictMode,{children:e.jsx(As,{})}));
